@* Pages/Shared/_Layout.cshtml *@
<!doctype html>
<html lang="ru" class="h-full">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Assistant</title>
    <link rel="icon" type="image/x-icon" href="~/favicon.ico" />
    <link rel="preload" href="~/favicon.ico" as="image" />

    <!-- Tailwind для прототипа -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="~/css/kc.css" asp-append-version="true" />

    @RenderSection("Head", required: false)
</head>
<body class="bg-dark-pattern text-surface-ink">
    <div class="app-shell">
        <header class="site-header">
            <a asp-page="/Index" class="site-logo">ASSISTANT</a>

            <div class="site-user">
                <span class="site-user__name">Hello, @User.Identity!.Name</span>
                <form method="post" asp-page="/Account/Logout" data-soft-ignore>
                    <button class="ghost-button" type="submit">Sign out</button>
                </form>
            </div>
        </header>

        @{
            var currentPage = (ViewContext.RouteData.Values["page"] as string) ?? string.Empty;
            var isAdmin = User.IsInRole("assistant-admin");
            var linkBase = "admin-link";
            string LinkClass(string target)
                => string.Equals(currentPage, target, System.StringComparison.OrdinalIgnoreCase)
                    ? $"{linkBase} admin-link--active"
                    : linkBase;
        }

        <div class="app-layout" data-soft-root>
            @if (isAdmin)
            {
                <aside class="admin-rail">
                    <div class="admin-rail__card">
                        <div class="admin-rail__title">Администрирование</div>
                        <nav class="admin-rail__nav" data-admin-nav>
                            <a asp-page="/Clients/Search" class='@LinkClass("/Clients/Search")'>
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                                    <circle cx="11" cy="11" r="8" />
                                    <path d="m21 21-4.3-4.3" />
                                </svg>
                                <span>Поиск клиентов</span>
                            </a>
                            <a asp-page="/Admin/UserClients" class='@LinkClass("/Admin/UserClients")'>
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                                    <path d="M16 7a4 4 0 1 1-8 0 4 4 0 0 1 8 0Z" />
                                    <path d="M5.5 21a6.5 6.5 0 0 1 13 0" />
                                </svg>
                                <span>Доступ пользователей</span>
                            </a>
                            <a asp-page="/Admin/Events" class='@LinkClass("/Admin/Events")'>
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                                    <path d="M21 7H3" />
                                    <path d="M21 11H3" />
                                    <path d="M15 15H3" />
                                    <path d="M9 19H3" />
                                    <path d="M17 2v3" />
                                    <path d="M7 2v3" />
                                    <rect width="18" height="18" x="3" y="4" rx="2" />
                                </svg>
                                <span>События</span>
                            </a>
                        </nav>
                    </div>
                </aside>
            }

            <main id="app" class="app-content">
                @RenderBody()
            </main>
        </div>
    </div>
    <div id="toastsHost">
        @RenderSection("Toasts", required: false)
    </div>
    <div id="pageScripts">
        @RenderSection("Scripts", required: false)
    </div>
    <script src="~/js/soft-navigation.js" asp-append-version="true"></script>
</body>
</html>
